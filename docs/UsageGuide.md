# 使い方ガイド

このドキュメントは日常操作向けの要点だけをまとめています。  
詳細な挙動・命名ルール・判定仕様は [仕様](dev/Specification.md) を参照してください。

## クイックスタート

1. ClipSave をインストール
2. 起動してタスクトレイにアイコンが出ることを確認
3. 保存したい内容をコピー
4. `Ctrl+Shift+V` で保存

## 起動動作（多重起動）

- ClipSave は **同一ユーザー / 同一セッション** で 1 インスタンスだけ動作します
- すでに起動中の状態で再起動した場合、新しいインスタンスは終了し、起動中インスタンスの設定画面を開きます

## 対応コンテンツと判定順

| 種別 | 拡張子 | 判定順 | 判定条件の要点 |
|------|--------|--------|----------------|
| 画像 | `.png` / `.jpg` | 1 | 画像がある場合は常に最優先 |
| 表データ | `.csv` | 2 | タブ区切りテキスト（2行2列以上） |
| JSON | `.json` | 3 | `{`/`[` で始まりパース可能 |
| Markdown | `.md` | 4 | 見出し・リスト・コードブロック等を検出 |
| テキスト | `.txt` | 5 | その他のプレーンテキスト |

## 保存先

ホットキーを押したとき、アクティブなウィンドウに応じて保存先が決まります。

| アクティブウィンドウ | 保存先 |
|----------------------|--------|
| デスクトップ | デスクトップフォルダ |
| エクスプローラー | 表示中のフォルダ |
| 上記以外 | 保存しない（通知なし） |

仮想フォルダ（PC / ごみ箱 等）が表示されているエクスプローラーでは保存しません。

## 設定と自動起動

設定画面を開くには、タスクトレイのアイコンを左クリックします（右クリックメニューの「設定」からも開けます）。

設定できる項目:

- 画像形式（PNG/JPG）と JPG 品質
- ファイル名（プレフィックス / タイムスタンプ）
- コンテンツ種別ごとの有効／無効
- ホットキーのキー設定
- 通知（成功／コンテンツなし／エラー）
- 詳細ログ
- UI 言語（英語 / 日本語）
- 設定画面のショートカット: `Ctrl+S` で保存、`Ctrl+W` / `Esc` で閉じる

自動起動はアプリ内では設定しません。Windows の「設定 > アプリ > スタートアップ」で切り替えます。
通知全体の ON/OFF もアプリ内では設定しません。Windows の「設定 > システム > 通知」で切り替えます。
どちらもトレイアイコン右クリックメニュー（「スタートアップ設定を開く」「通知設定を開く」）から直接開けます。

## データ保存先

| 種別 | MSIX インストール版 | 開発実行（非パッケージ） |
|------|----------------------|----------------------------|
| アプリデータルート | `%LOCALAPPDATA%\Packages\<PackageFamilyName>\LocalState\ClipSave` | `%APPDATA%\ClipSave` |
| 設定ファイル | `<アプリデータルート>\settings.json` | `<アプリデータルート>\settings.json` |
| ログ | `<アプリデータルート>\logs` | `<アプリデータルート>\logs` |
| クラッシュダンプ | `<アプリデータルート>\dumps` | `<アプリデータルート>\dumps` |

## バージョン情報

トレイアイコンを右クリックして「バージョン情報」を選択すると、以下の情報を確認できます。

- アプリケーションバージョン
- .NET ランタイムバージョン
- OS バージョン
- ビルド日時
- 著作権情報

サポートへの問い合わせ時にこれらの情報を添えると、トラブルシューティングがスムーズになります。

## 通知とログ

- 通知はバルーン通知で表示される
- 通知全体の ON/OFF は Windows の通知設定で管理する
- アプリ側では「保存成功」「コンテンツなし」「エラー」を個別に ON/OFF できる
- 詳細ログは既定で OFF（設定で有効化）
- 詳細ログは日次ローテーションし、最新 7 ファイルを保持する
- ログ出力先は「データ保存先」を参照

## プライバシー

- ネットワーク通信やテレメトリはありません
- データはローカルにのみ保存されます

## トラブルシューティング

予期しないエラーが発生した場合、自動的にダンプファイルが生成されます。

- **ダンプファイルの場所**: 「データ保存先」の `クラッシュダンプ` を参照
- **ファイル名**: `crash-yyyyMMdd-HHmmss-fff.txt`
- **内容**: タイムスタンプ、アプリ/OS 情報、例外詳細、スタックトレース、設定情報（取得可能な場合）

サポートへの問い合わせ時にダンプファイルを添付すると、問題解決が早くなります。

## アンインストールとデータ削除

- Windows の「アプリと機能」からアンインストール
- MSIX 版はアンインストール時にアプリデータ（設定・ログ・ダンプ）が削除される
- 開発実行（非パッケージ）で作成したデータを消す場合のみ `%APPDATA%\ClipSave` を手動削除

## 関連ドキュメント

- [製品コンセプト](ProductConcept.md) - ビジョンと設計思想
- [仕様](dev/Specification.md) - 詳細仕様（SPEC-ID）
